---
layout: default
title: Patches
description: View and manage generated code patches
scripts:
  - /assets/js/patches.js
---

<div class="space-y-6">
    <!-- Header -->
    <div class="bg-white rounded-lg shadow-sm p-6">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Code Patches</h1>
                <p class="text-gray-600 mt-2">View and manage your generated code patches</p>
            </div>
            <div class="flex space-x-3">
                <button onclick="location.href='/todos'" class="btn-secondary px-6 py-3 rounded-lg font-medium">
                    <i class="fas fa-tasks mr-2"></i>Create from Todo
                </button>
                <button onclick="clearAllPatches()" class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200">
                    <i class="fas fa-trash mr-2"></i>Clear All
                </button>
            </div>
        </div>
    </div>

    <!-- Search and Filters -->
    <div class="card p-6">
        <div class="flex flex-col md:flex-row gap-4">
            <div class="flex-1">
                <div class="relative">
                    <input type="text" id="search-input" placeholder="Search patches..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
            </div>
            <div class="flex gap-2">
                <select id="language-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                    <option value="">All Languages</option>
                    <option value="python">Python</option>
                    <option value="javascript">JavaScript</option>
                    <option value="typescript">TypeScript</option>
                    <option value="java">Java</option>
                    <option value="cpp">C++</option>
                    <option value="go">Go</option>
                    <option value="rust">Rust</option>
                </select>
                <button onclick="clearFilters()" class="px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200">
                    <i class="fas fa-times mr-1"></i>Clear
                </button>
            </div>
        </div>
    </div>

    <!-- Actions Bar -->
    <div class="flex justify-between items-center">
        <div class="flex items-center space-x-4">
            <span class="text-sm text-gray-500" id="patch-count">0 patches</span>
        </div>
        <div class="flex items-center space-x-2">
            <button onclick="refreshPatches()" class="p-2 text-gray-500 hover:text-gray-700">
                <i class="fas fa-refresh"></i>
            </button>
        </div>
    </div>

    <!-- Patches Grid -->
    <div id="patches-container" class="grid grid-cols-1 xl:grid-cols-2 2xl:grid-cols-3 gap-4 lg:gap-6">
        <div class="flex items-center justify-center py-12 col-span-full">
            <div class="loading"></div>
            <span class="ml-2 text-gray-500">Loading patches...</span>
        </div>
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="hidden text-center py-12">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <i class="fas fa-code text-gray-400 text-2xl"></i>
        </div>
        <h3 class="text-lg font-medium text-gray-900 mb-2">No patches found</h3>
        <p class="text-gray-500 mb-4">Generate your first code patch from a todo</p>
        <button onclick="location.href='/todos'" class="btn-primary px-6 py-3 rounded-lg">
            <i class="fas fa-tasks mr-2"></i>Create Todo
        </button>
    </div>
</div>

<!-- Patch Details Modal -->
<div id="patch-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
            <div class="flex items-center justify-between p-6 border-b">
                <h3 class="text-lg font-semibold text-gray-900" id="patch-modal-title">Patch Details</h3>
                <button onclick="hidePatchModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6 space-y-6">
                <!-- Patch Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-medium text-gray-900 mb-2">Patch Information</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-500">ID:</span>
                                <span class="font-mono" id="patch-id"></span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Language:</span>
                                <span id="patch-language"></span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Created:</span>
                                <span id="patch-created"></span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-500">Description:</span>
                                <span id="patch-description"></span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-medium text-gray-900 mb-2">Actions</h4>
                        <div class="space-y-2">
                            <button onclick="executePatch(currentPatch.patch_id)" class="w-full btn-primary px-4 py-2 rounded-md text-sm">
                                <i class="fas fa-play mr-2"></i>Execute Patch
                            </button>
                            <button onclick="regenerateCode(currentPatch.patch_id)" class="w-full px-4 py-2 bg-yellow-100 text-yellow-700 rounded-md text-sm hover:bg-yellow-200">
                                <i class="fas fa-sync-alt mr-2"></i>Regenerate Code
                            </button>
                            <button onclick="viewPatchFiles()" class="w-full btn-secondary px-4 py-2 rounded-md text-sm">
                                <i class="fas fa-folder mr-2"></i>View Files
                            </button>
                            <button onclick="pushToGit()" class="w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200">
                                <i class="fab fa-git-alt mr-2"></i>Push to Git
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Requirements -->
                <div id="patch-requirements-section" class="hidden">
                    <h4 class="font-medium text-gray-900 mb-2">Requirements</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <pre id="patch-requirements" class="text-sm text-gray-700 whitespace-pre-wrap"></pre>
                    </div>
                </div>

                <!-- Live Execution Console -->
                <div id="live-console-section" class="hidden">
                    <h4 class="font-medium text-gray-900 mb-2">Live Execution Console</h4>
                    <div class="bg-black rounded-lg p-4 h-96 overflow-y-auto">
                        <div id="console-output" class="text-green-400 font-mono text-sm space-y-1">
                            <!-- Console messages will be added here -->
                        </div>
                    </div>
                    <div class="flex items-center justify-between mt-2">
                        <div class="flex items-center space-x-2">
                            <div id="console-status" class="flex items-center">
                                <div class="w-2 h-2 bg-gray-400 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-600">Ready</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="clearConsole()" class="px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">
                                Clear
                            </button>
                            <button onclick="toggleConsole()" class="px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">
                                Hide
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Execution Results -->
                <div id="execution-results" class="hidden">
                    <h4 class="font-medium text-gray-900 mb-2">Execution Results</h4>
                    <div class="space-y-4">
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Status</h5>
                            <div id="execution-status" class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium"></div>
                        </div>
                        <div id="execution-output-section" class="hidden">
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Output</h5>
                            <div class="bg-gray-50 rounded-lg p-4">
                                <pre id="execution-output" class="text-sm text-gray-700 whitespace-pre-wrap"></pre>
                            </div>
                        </div>
                        <div id="execution-error-section" class="hidden">
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Error Output</h5>
                            <div class="bg-red-50 rounded-lg p-4">
                                <pre id="execution-error" class="text-sm text-red-700 whitespace-pre-wrap"></pre>
                            </div>
                        </div>
                        <div id="analysis-section" class="hidden">
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Analysis</h5>
                            <div class="bg-blue-50 rounded-lg p-4">
                                <p id="execution-analysis" class="text-sm text-blue-700"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Web Application Controls -->
                <div id="web-app-section" class="hidden">
                    <h4 class="font-medium text-gray-900 mb-2">Web Application</h4>
                    <div class="space-y-4">
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Status</h5>
                            <div id="web-app-status" class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium gray-badge">
                                <i class="fas fa-pause mr-1"></i>Stopped
                            </div>
                        </div>
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Access URL</h5>
                            <a id="web-app-url" href="#" target="_blank" class="text-blue-600 hover:text-blue-800 font-mono text-sm">http://localhost:5000</a>
                        </div>
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-1">Controls</h5>
                            <div id="web-app-controls" class="flex space-x-2">
                                <button onclick="startWebApp(currentPatch.patch_id)" class="btn-primary px-3 py-2 rounded-md text-sm">
                                    <i class="fas fa-play mr-1"></i>Start App
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- File Structure -->
                <div id="file-structure-section" class="hidden">
                    <h4 class="font-medium text-gray-900 mb-2">File Structure</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <pre id="file-structure" class="text-sm text-gray-700"></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Git Push Modal -->
<div id="git-push-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
            <div class="flex items-center justify-between p-6 border-b">
                <h3 class="text-lg font-semibold text-gray-900">Push to Git</h3>
                <button onclick="hideGitPushModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="git-push-form" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Commit Message</label>
                    <input type="text" id="commit-message" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Add patch: [patch-id]">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Remote</label>
                        <input type="text" id="git-remote" value="origin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Branch</label>
                        <input type="text" id="git-branch" value="main" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="hideGitPushModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">
                        Cancel
                    </button>
                    <button type="submit" class="btn-primary px-4 py-2 rounded-md">
                        Push to Git
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-patch-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fas fa-exclamation-triangle text-red-600"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900">Delete Patch</h3>
                        <p class="text-gray-500">This action cannot be undone.</p>
                    </div>
                </div>
                <p class="text-gray-700 mb-6">Are you sure you want to delete patch "<span id="delete-patch-id" class="font-medium"></span>"?</p>
                <div class="flex justify-end space-x-3">
                    <button onclick="hideDeletePatchModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">
                        Cancel
                    </button>
                    <button onclick="confirmDeletePatch()" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>
</div> 